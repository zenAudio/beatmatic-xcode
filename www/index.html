<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name = "format-detection" content = "telephone=no"/>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width;" />
        <link rel="stylesheet" type="text/css" href="css/less/colours.css" />
        <link rel="stylesheet" type="text/css" href="css/less/tiles.css" />
        <link rel="stylesheet" type="text/css" href="css/main.css" />
        <link rel="stylesheet" type="text/css" href="css/retina.css" media="only screen and (-webkit-min-device-pixel-ratio: 2)" />

        <title>BEATmatic</title>
    </head>
    <body>
    <div id="ui" class="ui">
    	<div id="main" class="uitab active">
    		<div id="recordLevel"></div>
	    	<div class="recordui ui"></div>
	        <div id="tutor1" class="tutor"></div>
	        <div id="tutor2" class="tutor"></div>
	        <div id="tutor3" class="tutor"></div>
	        <div class="ui" style="position: absolute;">
	        	<p id="tutorialBtn" class="btn">How it<br>works</p>
	        	<p id="demoBtn" class=" btn">Demo<br>Beat</p>
	        	<p id="recordBtn" class="btn">Record me<br> Beatboxing</p>
	        	<p id="stopBtn" class="btn hide">Stop<br> Recording</p>
	        	<p id="processingBtn" class="btn hide">Processing</p>
	        </div>
        </div>
        <div id="synth2" class="uitab ">
        	<div data-role="header" data-theme="b" data-position="inline" class="ui-header ui-bar-b" role="banner">
				<h1 class="ui-title" role="heading" aria-level="1">Modify detected beat</h1>
				<a href="#" data-rel="back" data-icon="arrow-l" data-theme="b" class="ui-btn-left ui-btn ui-shadow ui-btn-corner-all ui-btn-icon-left ui-btn-up-b" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Back</span><span class="ui-ui-icon--l ui--shadow">&nbsp;</span></span></a>
				<a href="#" data-theme="b" class="ui-btn-right ui-btn ui-shadow ui-btn-corner-all ui-btn-up-b" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Next</span></span></a>
			</div>
        	<div id="scrollbars" class="obars">
        	</div>
        	<div id="playbars" class="obars">
        	</div>
        	<div id="bars">
        	</div>
        </div>
        <div id="synth" class="uitab">
        	
        	<div id="content">
        		<div id="matrix"></div>
        		<div id="snext"><img id="sshare" src="img/share.png" alt="Share"/> <img id="sback" src="img/back.png" alt="back"/></div>
        		<div id="swipeVolumeLayover">BPM</div>
        		<div id="swipeSampleLayover"></div>
        	</div>
        
        </div>
        
        <div id="dj2" class="uitab ">
        	<div id="music" style="position: absolute; top: 5px; left: 5px; width: 70px; height: 200px; border: 1px solid blue;">
        		<h3 style="color: #24A2E2;">Drums</h3>
        		<div class="canvBtn">
        			<img src="img/btn-drum.png" alt="" style="position: absolute"/>
        			<canvas id="c11"></canvas>
        		</div>
        		<div>
        			<canvas id=""></canvas>
        		</div>
        		<div>
        			<canvas id=""></canvas>
        		</div>
        	</div>
        	
        	<div id="music" style="position: absolute; top: 5px; left: 80px; width: 140px; height: 200px; border: 1px solid blue;">
        		<h3 style="color: #27ABA9;">Vocals</h3>
        		<canvas id="c111"></canvas>
        		<canvas id="" style="border: 1px solid red; position: relative"></canvas>
        		<canvas id=""></canvas>
        		<canvas id="c1"></canvas>
        		<canvas id=""></canvas>
        		<canvas id="paint_area"></canvas>
        	</div>
        </div>
        <div id="dj" class="uitab">
        	
            	<div class="tiles">
            		<div class="tilerow">
            			<div class="tilehead onehead">Solos</div>
            			<div class="tilehead onehead">Samples</div>
            			<div class="tilehead onehead">Vocals</div>
            			<div class="tilehead onehead">FX</div>
            		</div>
            	</div>
                <div class="tiles" style="width: 500px;">
        			<div class="tilerow">
        				<div name="drums.kickdrum" class="tile one bluebg djbtn active">Kickdrum</div>
        				<div name="sample.baseline" class="tile one limebg djbtn">Baselines</div>
        				<div name="vocal.chor" class="tile one djbtn tealbg">Chor</div>
        				<div name="fx.highpass" class="tile one djbtn magentabg">Highpass</div>
        				
        			</div>
        			
        			<div class="tilerow">
        				<div name="drums.snare" class="djbtn tile one bluebg active">Snare</div>
        				<div name="sample.percussion" class="djbtn tile one limebg">Percussion</div>
        				<div name="vocal.xxx" class="djbtn tile one tealbg">xxx</div>
        				<div name="fx.tapestop" class="djbtn tile one magentabg">TapeStop</div>
        			</div>
        
        			<div class="tilerow">
        				<div name="drums.hihat" class="djbtn tile one bluebg active">HiHat</div>
        				<div name="sample.synth" class="djbtn tile one limebg">Synths</div>
        				<div name="vocal.yyy" class="djbtn tile one tealbg">Alicia</div>
        				<div name="fx.kickdrum" class="djbtn tile one magentabg">Filter3</div>
        			</div>
        			<div class="tilerow">
        				<div name="crazy" class="djbtn tile one bluebg">crazy shit</div>
        				<div name="sample.melodic" class="djbtn tile one limebg djbtn">Melodics</div>
        				<div name="vocal.chor" class="djbtn tile one tealbg">Yours<h1>#2</h1></div>
        				<div name="RETURN" class="returnbtn tile one magentabg"><img src="img/back.png" alt="back"/></div>
        			</div>
        		</div>
        		<div id="swipeDJVolumeLayover">BPM</div>
        		<div id="swipeDJSampleLayover"></div>
            </div>
        <div id="share" class="uitab">
        
        	<a href="#" class="gotoMain">
    	    <div class="app app2">
    	        <h1 style="color: white;">BeatMaticâ„¢ Share</h1>
    	        <div id="deviceready">
    	            <p class="status blink">Share</p>
    	        </div>
    	    </div>
    	    </a>
        	    
        </div>
        <div id="test" class="uitabs">
        </div>
     </div>
        <script type="text/javascript" src="cordova-2.1.0.js"></script>
        <script type="text/javascript" src="js/jquery-1.8.0.js"></script>
        <script type="text/javascript" src="js/jquery.touchSwipe.js"></script>
        <script type="text/javascript" src="js/jquery-scrollspy.js"></script>
       
        
        <script type="text/javascript" src="coffee/ui.js"></script>
         <script type="text/javascript" src="coffee/SoundBtn.js"></script>
        <script type="text/javascript" src="coffee/diracplayer.js"></script>
        <script type="text/javascript" src="coffee/sequencer.js"></script>
        <script type="text/javascript" src="coffee/audioengine.js"></script>
        
        <script type="text/javascript" src="coffee/record.js"></script>
        <script type="text/javascript" src="coffee/play.js"></script>
        <script type="text/javascript" src="coffee/dj.js"></script>
<!--
        <script src="http://debug.phonegap.com/target/target-script-min.js#beatmatic"></script>

        <script type="text/javascript">
            document.addEventListener("deviceready", onDeviceReady, false);
            
            var recordFile = null;
            var recording = false;
						var playingScore = false;
						var playingSample = false;
						var filename = "mptest.wav";
            
            function onDeviceReady() {
                $(document).ready(function() {
									$('#playAudioBtn').button('disable');
									$('#playBtn').bind('touchstart', function() {
										if (!playingScore) {
											console.log("MPD: HTML: pressed play");
											BEATmatic.audioEngine.play();
											playingScore = true;
											$(this).val('Stop');
											$(this).button('refresh');
										} else {
											console.log("MPD: HTML: pressed stop");
											BEATmatic.audioEngine.stop();
											playingScore = false;
											$(this).val('Play');
											$(this).button('refresh');
										}
									});
									$('#playAudioBtn').bind('touchstart', function () {
										if (!playingSample) {
											window.requestFileSystem(LocalFileSystem.PERSISTENT, 0,
												function (fs) {
													fs.root.getFile(filename, {create: false}, 
														function (fileEntry) {
															playingSample = true;
															BEATmatic.audioEngine.playSample(fileEntry.fullPath, function (response) {
																console.log("FINISHED PLAYING SAMPLE");
																$('#playAudioBtn').val('Audition');
																$('#playAudioBtn').button('refresh');
															});
															$('#playAudioBtn').val('Stop');
															$('#playAudioBtn').button('refresh');
													}, function() {})
												}, function () {});
											} else {
												playingSample = false;
												BEATmatic.audioEngine.stopSample();
												$('#playAudioBtn').val('Audition');
												$('#playAudioBtn').button('refresh');
											}
										});
									$('#recordAudioBtn').bind('touchstart', function () {
										try {
												if (recording) {
														console.log("MPD: HTML: Stopping recording.");
														$('#recordAudioBtn').val('Record');
														$('#recordAudioBtn').button('refresh');
														recording = false;
														BEATmatic.audioEngine.recordAudioStop(function (response) {
															$('#playAudioBtn').button('enable');
														});
												} else {
														console.log("MPD: HTML: Recording to: " + recordFile);
														// grab a file to record to.
														window.requestFileSystem(LocalFileSystem.PERSISTENT, 0,
															function (fs) {
																console.log("MPD: got here");
																fs.root.getFile(filename, {create: true}, 
																	function (fileEntry) {
																		console.log("MPD: got here: " + fileEntry.name);
																		$('#recordAudioBtn').val('Stop');
																		$('#recordAudioBtn').button('refresh');
																		recording = true;
																		BEATmatic.audioEngine.recordAudioStart(fileEntry.fullPath);
																}, function() {})
															}, function () {});
												}
										} catch (e) {
												console.log(e.message);
										}
									});
									function toggleLoop(group, ix) {
										try {
												console.log("MPD: HTML: pressed toggle loop " + group + ", " + ix);
												BEATmatic.audioEngine.toggleLoop(group, ix);
										} catch (e) {
												console.log(e.message);
										}
									}
									$('#synthABtn').bind('touchstart', function () {
										toggleLoop('synth', 0);
									});
									$('#synthBBtn').bind('touchstart', function () {
										toggleLoop('synth', 1);
									});
									$('#bassABtn').bind('touchstart', function () {
										toggleLoop('melodic', 7);
									});
									$('#bassBBtn').bind('touchstart', function () {
										toggleLoop('melodic', 8);
									});
                  $('#filterSlider').bind('change', function() {
                     var cutoff = $(this).val() / 100.0 * 4000.0;
                     BEATmatic.audioEngine.setMasterFilter({type: "lp", options: {"cutoff": cutoff}});
                  });
                  $('#crusherSlider').bind('change', function() {
                     var bits = ($(this).val()+20)*16 / 80;
                     var rate = $(this).val() / 100.0;
                     BEATmatic.audioEngine.setMasterCrusher({"bits": bits, "rate": rate});
                  });
                  $('#verbSlider').bind('change', function() {
                     var x = $(this).val() / 100.0;
                     BEATmatic.audioEngine.setMasterVerb({roomSize: x, wetLevel: x, dryLevel: 1.0-x});
                  });
                  $( "#bpmSlider" ).bind("change", function () {
                     BEATmatic.audioEngine.setBpm($(this).val());
                  });
							  });

                BEATmatic.audioEngine.setCursorCallback(function (cursorPosJson) {
//                    console.log("MPD: JS: playback cursor: " + cursorPosJson);
                    var time = JSON.parse(cursorPosJson);
                    $("#timeKeeper").text(time.bars + "." + time.beats + "." + time.ticks);
                });
                BEATmatic.audioEngine.init("sounds/drummachine/defpreset/preset.json", "sounds/looper/defpreset/preset.json");
                console.log("MPD:HTML:onDeviceReady: initialized drum preset.");
                var json = JSON.stringify({
										"bpm": 120,
										"tracks": [
											 {
												 "name": "kick drum",
												 "score": [100,0,0,0,  100,0,0,0,  100,0,0,0,  100,0,0,100]
											 },
											 {
												 "name": "snare drum",
												 "score": [0,0,0,0,    100,0,0,0,   0,0,0,0,   100,0,0,0]
											 },
											 {
												 "name": "hi-hat",
												 "score": [0,0,100,0,  0,0,100,0,  0,0,100,0,   0,0,100,0]
											 }
									 ]});

                console.log("MPD:HTML:onDeviceReady: about to set drum pattern to " + json);
                BEATmatic.audioEngine.setDrumPattern(json);
                console.log("MPD:HTML:onDeviceReady:set drum pattern.");
                
            }
            function playTestTone() {
                try {
//                    console.log(BEATmatic.audioEngine);
                    BEATmatic.audioEngine.playTestTone();
                } catch (e) {
                    console.log(e.message);
                }
            }
            function audition(soundName) {
                try {
                    console.log("MPD: HTML: auditioning sound " + soundName);
                    BEATmatic.audioEngine.auditionDrum(soundName);
                } catch (e) {
                    console.log(e.message);
                }
            }
        </script>-->

    </body>
</html>
